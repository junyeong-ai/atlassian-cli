# Atlassian CLI

[![CI](https://github.com/junyeong-ai/atlassian-cli/workflows/CI/badge.svg)](https://github.com/junyeong-ai/atlassian-cli/actions)
[![Lint](https://github.com/junyeong-ai/atlassian-cli/workflows/Lint/badge.svg)](https://github.com/junyeong-ai/atlassian-cli/actions)
[![Rust](https://img.shields.io/badge/rust-1.91.1%2B%20(2024%20edition)-orange?style=flat-square&logo=rust)](https://www.rust-lang.org)
[![Version](https://img.shields.io/badge/version-0.1.0-blue?style=flat-square)](https://github.com/junyeong-ai/atlassian-cli/releases)

> **üåê [ÌïúÍµ≠Ïñ¥](README.md)** | **English**

---

> **‚ö° Fast and Powerful Atlassian Cloud Command-Line Tool**
>
> - üöÄ **3.8MB single binary** (no runtime required)
> - üìä **14 operations** (Jira 8 + Confluence 6)
> - üéØ **Field optimization** (60-70% response size reduction)
> - üîß **4-tier config** (CLI ‚Üí ENV ‚Üí Project ‚Üí Global)

---

## ‚ö° Quick Start (1 minute)

```bash
# 1. Install
curl -fsSL https://raw.githubusercontent.com/junyeong-ai/atlassian-cli/main/scripts/install.sh | bash

# 2. Initialize config
atlassian config init --global

# 3. Set token
# Edit ~/.config/atlassian-cli/config.toml
# Enter domain, email, token

# 4. Start using! üéâ
atlassian jira search "status = Open" --limit 5
atlassian confluence search "type=page AND space=TEAM"
```

**Tip**: [Generate API Token](https://id.atlassian.com/manage-profile/security/api-tokens) required

---

## üéØ Key Features

### Jira Operations
```bash
# Search issues (JQL)
atlassian jira search "project = TMS AND status = Open" --limit 10
atlassian jira search "assignee = currentUser() AND status != Done"

# Get issue
atlassian jira get PROJ-123

# Create issue
atlassian jira create PROJ "Bug fix" Bug --description "Details"

# Update issue
atlassian jira update PROJ-123 '{"summary":"New title"}'

# Add comment
atlassian jira comment add PROJ-123 "Work completed"

# Transition
atlassian jira transitions PROJ-123
atlassian jira transition PROJ-123 31
```

### Confluence Operations
```bash
# Search pages (CQL)
atlassian confluence search 'type=page AND space="TEAM"' --limit 10

# Get page
atlassian confluence get 123456

# Create page
atlassian confluence create TEAM "API Docs" "<p>Content</p>"

# Update page
atlassian confluence update 123456 "API Docs v2" "<p>New content</p>"

# List children
atlassian confluence children 123456

# Get comments
atlassian confluence comments 123456
```

### Config & Optimization
```bash
# Config management
atlassian config show            # Show config (masked token)
atlassian config path            # Config file path
atlassian config edit            # Edit with default editor

# Field optimization (60-70% size reduction)
atlassian jira search "project = PROJ" --fields key,summary,status
export JIRA_SEARCH_DEFAULT_FIELDS="key,summary,status"
export JIRA_SEARCH_CUSTOM_FIELDS="customfield_10015"

# JSON output
atlassian jira get PROJ-123 | jq -r '.fields.summary'
```

**Important Notes**:
- Field optimization: 17 default fields (excludes `description`, `id`, `renderedFields`)
- Project filter: Access control with `projects_filter`
- ADF auto-conversion: Plain text ‚Üí Atlassian Document Format

---

## üì¶ Installation

### Method 1: Prebuilt Binary (Recommended) ‚≠ê

**Automated install**:
```bash
curl -fsSL https://raw.githubusercontent.com/junyeong-ai/atlassian-cli/main/scripts/install.sh | bash
```

**Manual install**:
1. Download binary from [Releases](https://github.com/junyeong-ai/atlassian-cli/releases)
2. Extract: `tar -xzf atlassian-*.tar.gz`
3. Move to PATH: `mv atlassian ~/.local/bin/`

**Supported Platforms**:
- Linux: x86_64, aarch64
- macOS: Intel (x86_64), Apple Silicon (aarch64)
- Windows: x86_64

### Method 2: Build from Source

```bash
git clone https://github.com/junyeong-ai/atlassian-cli
cd atlassian-cli
cargo build --release
cp target/release/atlassian ~/.local/bin/
```

**Requirements**: Rust 1.91.1+

### ü§ñ Claude Code Skill (Optional)

When running `./scripts/install.sh`, you can choose to install the Claude Code skill:

- **User-level** (recommended): Available in all projects
- **Project-level**: Auto-distributed to team via git
- **Skip**: Manual installation later

The skill enables natural language Jira/Confluence queries in Claude Code.

---

## üîë Generate API Token

1. Visit [Atlassian API Tokens](https://id.atlassian.com/manage-profile/security/api-tokens)
2. Click "Create API token"
3. Enter label (e.g., "atlassian-cli")
4. Copy token and add to config file

**Security**: Treat token like password. Regenerate immediately if exposed.

---

## ‚öôÔ∏è Configuration

### Config File

**Location**:
- macOS/Linux: `~/.config/atlassian-cli/config.toml`
- Windows: `%APPDATA%\atlassian-cli\config.toml`
- Project: `./.atlassian.toml`

**Default config** (generated by `atlassian config init`):
```toml
[default]
domain = "company.atlassian.net"
email = "user@example.com"
token = "your-api-token"

[default.jira]
projects_filter = ["PROJ1", "PROJ2"]

[default.confluence]
spaces_filter = ["TEAM", "DOCS"]

[performance]
request_timeout_ms = 30000
```

### Environment Variables

```bash
export ATLASSIAN_DOMAIN="company.atlassian.net"
export ATLASSIAN_EMAIL="user@example.com"
export ATLASSIAN_API_TOKEN="your-token"

# Field optimization
export JIRA_SEARCH_DEFAULT_FIELDS="key,summary,status"
export JIRA_SEARCH_CUSTOM_FIELDS="customfield_10015"
export CONFLUENCE_CUSTOM_INCLUDES="ancestors,history"
```

### Config Priority

```
CLI flags > Environment variables > Project config > Global config
```

**Example**:
```bash
# Override config file
atlassian --domain company.atlassian.net --email user@example.com \
  jira search "status = Open"
```

---

## üèóÔ∏è Core Architecture

4-tier priority config, ADF auto-conversion, field optimization (17 default fields).
For detailed architecture, see [CLAUDE.md](CLAUDE.md).

---

## üîß Troubleshooting

### Config Not Found

**Checklist**:
- [ ] Config file exists: `atlassian config path`
- [ ] Config content: `atlassian config show`
- [ ] Domain format: `company.atlassian.net` (without https://)

**Solution**:
```bash
atlassian config init --global
```

### API Authentication Failed

**Checklist**:
- [ ] Email format valid
- [ ] Token correct (watch for copy/paste spaces)
- [ ] Domain format correct

**Test token**: Check masked token with `atlassian config show`

### Field Filtering Not Working

**Priority check**:
1. CLI `--fields` (highest priority)
2. `JIRA_SEARCH_DEFAULT_FIELDS` environment variable
3. Default 17 fields + `JIRA_SEARCH_CUSTOM_FIELDS`

```bash
# Test
JIRA_SEARCH_DEFAULT_FIELDS="key,summary" atlassian jira search "project = PROJ"
```

### Project Access Restriction

With `projects_filter`, JQL auto-injected:
```
Input: status = Open
Executed: project IN (PROJ1,PROJ2) AND (status = Open)
```

---

## üìö Command Reference

### Jira Commands (8)

| Command | Description | Example |
|---------|-------------|---------|
| `get <KEY>` | Get issue | `atlassian jira get PROJ-123` |
| `search <JQL>` | JQL search | `atlassian jira search "status = Open" --limit 10` |
| `create <PROJECT> <SUMMARY> <TYPE>` | Create issue | `atlassian jira create PROJ "Title" Bug --description "Text"` |
| `update <KEY> <JSON>` | Update issue | `atlassian jira update PROJ-123 '{"summary":"New"}'` |
| `comment add <KEY> <TEXT>` | Add comment | `atlassian jira comment add PROJ-123 "Comment"` |
| `comment update <KEY> <ID> <TEXT>` | Update comment | `atlassian jira comment update PROJ-123 123 "Updated"` |
| `transitions <KEY>` | List transitions | `atlassian jira transitions PROJ-123` |
| `transition <KEY> <ID>` | Transition issue | `atlassian jira transition PROJ-123 31` |

### Confluence Commands (6)

| Command | Description | Example |
|---------|-------------|---------|
| `search <CQL>` | CQL search | `atlassian confluence search "type=page" --limit 10` |
| `get <ID>` | Get page | `atlassian confluence get 123456` |
| `create <SPACE> <TITLE> <CONTENT>` | Create page | `atlassian confluence create TEAM "Title" "<p>HTML</p>"` |
| `update <ID> <TITLE> <CONTENT>` | Update page | `atlassian confluence update 123456 "Title" "<p>HTML</p>"` |
| `children <ID>` | List children | `atlassian confluence children 123456` |
| `comments <ID>` | Get comments | `atlassian confluence comments 123456` |

### Config Commands (5)

| Command | Description | Example |
|---------|-------------|---------|
| `init [--global]` | Initialize config | `atlassian config init --global` |
| `show` | Show config (masked token) | `atlassian config show` |
| `list` | List config locations | `atlassian config list` |
| `path [--global]` | Config file path | `atlassian config path` |
| `edit [--global]` | Edit with editor | `atlassian config edit` |

### Common Options

| Option | Description | Applies To |
|--------|-------------|------------|
| `--domain <DOMAIN>` | Override domain | All commands |
| `--email <EMAIL>` | Override email | All commands |
| `--token <TOKEN>` | Override token | All commands |
| `--profile <NAME>` | Select profile | All commands |
| `--fields <FIELDS>` | Specify fields (comma-separated) | jira search, jira get |
| `--limit <N>` | Limit results | jira search, confluence search |
| `--description <TEXT>` | Description (ADF auto-conversion) | jira create, jira update |

**Notes**:
- Domain format: `company.atlassian.net` (without https://)
- ADF auto-conversion: Plain text ‚Üí JSON ADF
- Field optimization: 17 default fields (`key,summary,status,...`)

---

## üöÄ Developer Guide

**Architecture, debugging, contribution guide**: See [CLAUDE.md](CLAUDE.md)

---

## üí¨ Support

- **GitHub Issues**: [Report issues](https://github.com/junyeong-ai/atlassian-cli/issues)
- **Developer Docs**: [CLAUDE.md](CLAUDE.md)

---

<div align="center">

**üåê [ÌïúÍµ≠Ïñ¥](README.md)** | **English**

**Version 0.1.0** ‚Ä¢ Rust 2024 Edition

Made with ‚ù§Ô∏è for productivity

</div>
